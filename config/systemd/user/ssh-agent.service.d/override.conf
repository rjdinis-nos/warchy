# Use a socket under XDG_RUNTIME_DIR that is guaranteed to support UNIX sockets
[Service]
# Let systemd create a runtime directory for ssh-agent
RuntimeDirectory=ssh-agent
RuntimeDirectoryMode=0700

# Set the socket path
Environment="SSH_AUTH_SOCK=%t/ssh-agent.sock"

# Clear previous ExecStart
ExecStart=

# Start ssh-agent with the socket under the runtime directory
ExecStart=/usr/bin/ssh-agent -D
