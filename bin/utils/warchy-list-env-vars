#!/usr/bin/env bash

# 1. Trim whitespace and filter empty arguments
filtered_args=()
for arg in "$@"; do
  # Trim leading/trailing whitespace
  trimmed=$(echo "$arg" | xargs)
  # Add non-empty args
  [ -n "$trimmed" ] && filtered_args+=("$trimmed")
done

# 2. Check if any valid arguments remain
if [ ${#filtered_args[@]} -eq 0 ]; then
  gum style --foreground 196 "âœ– Error: No variables provided as arguments."
  echo "Usage: $0 variable1 variable2 ..."
  exit 1
fi

# 3. Join arguments with | to create a valid regex: (var1|var2|var3)
regex_pattern=$(
  IFS='|'
  echo "${filtered_args[*]}"
)

# 4. Use grep -E with the corrected pattern
env | grep -E "^($regex_pattern)=" | sort | while IFS= read -r line; do

  # Split the "NAME=VALUE" string
  name="${line%%=*}"
  value="${line#*=}"

  # Print using combined gum style commands
  echo "$(gum style --foreground 212 "   $name")$(gum style --foreground 245 ": $value")"

done
